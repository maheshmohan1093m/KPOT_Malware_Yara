rule KPOT_v2_Malware
{
    meta:
        Description = "To detect KPOT Malware Payload"
        Author = "Mahesh M"
        Repo = "https://github.com/maheshmohan1093m/KPOT_Malware_Yara"
        Date = "2021-08-27"
    strings:
        $ma1 = "%s: %s | %02d/%04d | %s" ascii fullword // Malware looks for String variable in this particular format
        $ma2 = "password-check" ascii fullword  // Malware has a string password-check which is usually common
	$ma3 = "http://%s" ascii fullword // Malware References a URL

        $ma4 = /(SMTP|POP3|IMAP)\sServer/ wide  // Regex string to see if the string contains SMTP or POP3 or IMAP Server
        $ma5 = /(SMTP|POP3|IMAP)\s(User|Password|Port)/ wide // Regex string to see if the string contains SMTP or POP3 or IMAP User or Password or Port
	$ma6 = /(HTTP)\sPassword/ wide // String to check if HTTP Password string is there

        $ma7 = "*.config" ascii wide fullword //Looking for .config string
        $ma8 = "HTTP Server URL" ascii wide fullword //  Looking to see if it contains string HTTP Server URL
        $ma9 = "Outlook.txt" ascii wide  // Looking to see if it has Outlook.txt
	$ma10 = "!This program cannot be run in DOS mode." //Common String between 2 malware
  	$z1 = "jkhgfdssfd.Resources" wide // Malware have Resources File
        $z2 = "jkhgfdssfd.Form1" wide  // Malware have Resources File
	$z3 = "9087654356.exe" wide// Malware References a malware exe file
    condition:
	all of ($ma*) or all of ($z*)       
}
