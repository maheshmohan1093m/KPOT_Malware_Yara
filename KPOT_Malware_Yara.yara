rule KPOT_v2_Malware_Payload
{
    meta:
        Description = "To detect KPOT Malware Payload"
        Author = "Mahesh M"
        Repo = "https://github.com/maheshmohan1093m/KPOT_Malware_Yara"
        Date = "2021-08-27"
    strings:
        $a = "%s: %s | %02d/%04d | %s" ascii fullword // Malware looks for String variable in this particular format
        $b = "password-check" ascii fullword  // Malware has a string password-check which is usually common
	$c = "http://%s" ascii fullword // Malware References a URL

        $d = /(SMTP|POP3|IMAP)\sServer/ wide  // Regex string to see if the string contains SMTP or POP3 or IMAP Server
        $e = /(SMTP|POP3|IMAP)\s(User|Password|Port)/ wide // Regex string to see if the string contains SMTP or POP3 or IMAP User or Password or Port
	$f = /(HTTP)\sPassword/ wide // String to check if HTTP Password string is there

        $g = "*.config" ascii wide fullword //Looking for .config string
        $h = "HTTP Server URL" ascii wide fullword //  Looking to see if it contains string HTTP Server URL
        $i = "Outlook.txt" ascii wide  // Looking to see if it has Outlook.txt
    condition:
        all of them
}

rule KPOT_v2_Malware_Intermediate Downloader
{
    meta:
        Description = "To detect KPOT Malware"
        Author = "Mahesh M"
        Repo = "https://github.com/maheshmohan1093m/KPOT_Malware_Yara"
        Date = "2021-08-27"
    strings:
        $a = "jkhgfdssfd.Resources" ascii fullword // Malware have Resources File
        $b = "jkhgfdssfd.Form1.resources" ascii fullword  // Malware have Resources File
	$c = "9087654356.exe" ascii fullword // Malware References a malware exe file
    condition:
        all of them
}

