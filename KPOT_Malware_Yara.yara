rule KPOT_v2_Malware
{
    meta:
        Description = "To detect KPOT Malware Payload"
        Author = "Mahesh M"
        Repo = "https://github.com/maheshmohan1093m/KPOT_Malware_Yara"
        Date = "2021-08-27"
    strings:
        $ma1 = "%s: %s | %02d/%04d | %s" ascii fullword // Malware do have a String of this particular format
        $ma2 = "password-check" ascii fullword  // Malware has a string password-check which is usually common
	$ma3 = "http://%s" ascii fullword // Malware References a URL

        $ma4 = "*.config" ascii wide fullword //Looking for .config string
        $ma5 = "%08x.%s" ascii wide fullword //  Looking to see if it contains string HTTP Server URL
        $ma6 = "Outlook.txt" ascii wide  // Looking to see if it has Outlook.txt
  	$z1 = "jkhgfdssfd.Resources" wide // Malware have Resources File
        $z2 = "jkhgfdssfd.Form1" wide  // Malware have Resources File
	$z3 = "9087654356.exe" wide// Malware References a malware exe file
    condition:
	all of ($ma*) or all of ($z*)       
}
